---
title: "Malware Detection: YARA"
date: 2025-06-14T20:35:35+02:00
math: false
tags: [YARA, yarGen, Loki]
categories: [malware]
---

# Introduction to YARA

**YARA** is a tool used to identify and classify malware based on textual or binary patterns. In this tutorial, we'll cover the basics of YARA and how to write simple rules to detect patterns in files.

---

## What Is YARA?

YARA (Yet Another Recursive Acronym) is a rule-based pattern matching engine developed by VirusTotal, widely used for:

- Detecting malware families
- Scanning files for custom signatures
- Automating threat detection in incident response

---

## Installation

### Linux:
```bash
sudo apt update
sudo apt install yara
```
### macOS:
```bash
brew install yara
```

### Windows:
Download it from [here](https://github.com/VirusTotal/yara).


## YARA rule example


```yara
rule examplerule
{
    strings:
        $a = "malicious_string"
        $b = { E2 34 A1 C4 23 } 
    condition:
        $a or $b
}
 ```
 
Running the rule:

```bash
yara examplerule.yar somefile
```

All Yara rules end with '.yar'. If the pattern is not found, you will see an error. Otherwise, it will show:

```nginx
examplerule somefile
```

## Using YARA with Loki
Loki is a IOC and YARA scanner created by Florian Roth. It scans for IOCs, malware, backdoors, and suspicious artifacts using YARA rules, hash lookups, and string matching.

### Install Loki

```bash
git clone https://github.com/Neo23x0/Loki.git
cd Loki
```

On Windows, download the ZIP version and extract it.

### Add YARA Rules
Place your .yar files into:

```bash
./signature-base/yara/
```

```bash
python loki.py -p /path
```


```csharp
[INFO] ==> Scanning file: path/maliciousfile.exe
[ALERT] YARA rule match: examplerule in maliciousfile.exe
```

### Commands:

--intense – deeper scan 

--noprocscan – skip process memory scanning

--debug – shows extra debug output


## yarGen to generate YARA rules
yarGen helps automate the process of creating YARA rules by extracting good strings and avoiding noise.

### Install yarGen

```bash
git clone https://github.com/Neo23x0/yarGen.git
cd yarGen
pip install -r requirements.txt
python yarGen.py --update
```

### Usage

```bash
python yarGen.py -m /path -o my_rule.yar
```



